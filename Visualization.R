library("ggplot2")
base <-ggplot() + xlim(0, 10)
base + geom_function(fun = function(x) x) + geom_function(fun = function(x) x/2 + 1/x) + 
  geom_point( aes(x = 8, y = 4 + 1/8), color = "#1E90FF") + 
  geom_vline(xintercept = c(8, 4 + 1/8, 2 + 1/16 + 1/(4 + 1/8), (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))), linetype="dotted", color = "#1E90FF") + 
  geom_hline(yintercept = c(4 + 1/8, 2 + 1/16 + 1/(4 + 1/8),(2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)),((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)))/2 + 1/((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)))), linetype="dotted", color = "#1E90FF") + 
  geom_hline(yintercept = 0) + geom_vline(xintercept = 0) + 
  geom_point( aes(x = 4 + 1/8, y = 4 + 1/8), color = "#1E90FF") + 
  geom_point( aes(x = 4 + 1/8, y = 2 + 1/16 + 1/(4 + 1/8)), color = "#1E90FF") + 
  geom_point( aes(x = 2 + 1/16 + 1/(4 + 1/8), y = 2 + 1/16 + 1/(4 + 1/8)), color = "#1E90FF") + 
  geom_point( aes(x = 2 + 1/16 + 1/(4 + 1/8), y = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))), color = "#1E90FF") + 
  geom_point( aes(x = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)), y = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))), color = "#1E90FF") + 
  geom_point( aes(x = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)), y = ((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)))/2 + 1/((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)))), color = "#1E90FF") + 
  geom_point( aes(x = sqrt(2), y = sqrt(2)), color = "#FF6103") + 
  geom_point( aes(x = c(8, 4 + 1/8, 2 + 1/16 + 1/(4 + 1/8), (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))), y = 0)) + 
  geom_point( aes(x = 0,  y = c(4 + 1/8, 2 + 1/16 + 1/(4 + 1/8),(2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))))) + 
  geom_point( aes(x = 0, y = ((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)))/2 + 1/((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))))) + 
  annotate("text", x = 9.9, y = 10.2, label = "y = x", cex = 4) + 
  annotate("text", x = 9.9, y = 5.5, label = "f(x)", cex = 4) + 
  annotate("text", x = 7.6, y = 4 + 1/8 + 1/3, label = "(x0, f(x0))", cex = 3) + 
  annotate("text", x = 4 + 1/8 - 1/2 + 1/14, y = 4 + 1/8 + 1/3, label = "(f(x0),f(x0))", cex = 3) + 
  annotate("text", x = 4 + 1/8 - 0.4, y = 2 + 1/16 + 1/(4 + 1/8) + 1/3, label = "(x1, f(x1))", cex = 3) + 
  annotate("text", x = 2 + 1/16 + 1/(4 + 1/8) - 0.4, y = 2 + 1/16 + 1/(4 + 1/8) + 1/3, label = "(f(x1),f(x1))", cex = 3) + 
  annotate("text", x = 2 + 1/16 + 1/(4 + 1/8) + 0.4, y = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)) - 1/5, label = "(x2, f(x2))", cex = 3) + 
  annotate("text", x = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)) - 0.4, y = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)) + 1/3, label = "(f(x2),f(x2))", cex = 3) + 
  annotate("text", x = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)) + 0.15, y = ((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)))/2 + 1/((2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8))) - 1/5, label = "(x3, f(x3))", cex = 3) + 
  annotate("text", x = 8, y = -1/5, label = "x0", cex = 3) + 
  annotate("text", x = 4 + 1/8, y = -1/5, label = "x1", cex = 3) + 
  annotate("text", x = 2 + 1/16 + 1/(4 + 1/8), y = -1/5, label = "x2", cex = 3) + 
  annotate("text", x = (2 + 1/16 + 1/(4 + 1/8))/2 + 1/(2 + 1/16 + 1/(4 + 1/8)), y = -1/5, label = "x3", cex = 3) + 
  labs(x ="x", y = "y")
  